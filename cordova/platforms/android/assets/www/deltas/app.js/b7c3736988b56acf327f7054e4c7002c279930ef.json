["function _ec84b07dc68d4b8de15cf38b13a9f68ca16c117b",50,47,"controller){DietonApp.controller={}}if(!DietonApp.model){DietonApp.model={}}if(!DietonApp.overrides){DietonApp.overrides={}}if(!DietonApp.store){DietonApp.store={}}",83,38,"if(!DietonApp.view.ux){DietonApp.view.ux",117,1010,1151,292893,296568,27018,"Ext.define(\"DietonApp.overrides.MessageBox\",{override:\"Ext.MessageBox\",statics:{YES:{text:\"Si\",itemId:\"yes\",ui:\"action\",iconAlign:\"left\"},NO:{text:\"No\",itemId:\"no\",iconAlign:\"right\"},YESNO:[{text:\"Si\",itemId:\"yes\",ui:\"action\"},{text:\"No\",itemId:\"no\"}]},hide:function(a){if(this.activeAnimation&&this.activeAnimation._onEnd){this.activeAnimation._onEnd()}return(arguments.callee.$previous||Ext.Sheet.prototype.hide).apply(this,arguments)}}",328081,95307,"identifier.Uuid\",Ext.data.identifier.Simple,{isUnique:true,config:{id:undefined,salt:null,timestamp:null,version:4},applyId:function(a){if(a===undefined){return Ext.data.identifier.Uuid.Global",222967,32,"){var a=this;Ext.data.identifier.Simple",294270,44,";a.parts=[];a.init()},reconfigure:function(a){this.setConfig(a);this.init()},generate:function(){var c=this,e=c.parts,a=c.getVersion(),b=c.getSalt(),d=c.getTimestamp();e[0]=c.toHex(d.lo,8);e[1]=c.toHex(d.hi&65535,4);e[2]=c.toHex(((d.hi>>>16)&4095)|(a<<12),4);e[3]=c.toHex(128|((c.clockSeq>>>8)&63),2)+c.toHex(c.clockSeq&255,2);e[4]=c.toHex(b.hi,4)+c.toHex(b.lo,8);if(a==4){c.init()}else{++d.lo;if(d.lo>=c.twoPow32){d.lo=0;++d.hi}}return e.join(\"-\").toLowerCase()},init:function(){var b=this,a=b.getSalt(),c=b.getTimestamp();if(b.getVersion()==4){b.clockSeq=b.rand(0,b.twoPow14-1);if(!a){a={};b.setSalt(a)}if(!c){c={};b.setTimestamp(c)}a.lo=b.rand(0,b.twoPow32-1);a.hi=b.rand(0,b.twoPow16-1);c.lo=b.rand(0,b.twoPow32-1);c.hi=b.rand(0,b.twoPow28-1)}else{b.setSalt(b.split(b.getSalt()));b.setTimestamp(b.split(b.getTimestamp()));b.getSalt().hi|=256}},twoPow14:Math.pow(2,14),twoPow16:Math.pow(2,16),twoPow28:Math.pow(2,28),twoPow32:Math.pow(2,32),toHex:function(c,b){var a=c.toString(16);if(a.length>b){a=a.substring(a.length-b)}else{if(a.length<b){a=Ext.String.leftPad(a,b,\"0\")}}return a},rand:function(a,c){var b=Math.random()*(c-a+1);return Math.floor(b)+a},split:function(b){if(typeof(b)==\"number\"){var a=Math.floor(b/this.twoPow32);return{lo:Math.floor(b-a*this.twoPow32),hi:a}}return b}},1,0,0,0,[\"data.identifier.uuid\"],0,[Ext.data.identifier,\"Uuid\"],function(){this.Global=new this({id:\"uuid\"})",369389,36,"WebStorage",369622,54,"WebStorageProxy\",config:{id:undefined,reader:null,writer:null,enablePagingParams:false,defaultDateFormat:\"Y-m-d H:i:s.u\"},constructor:function(a){Ext.data.proxy.Clien",501840,46,"this.cache={}},updateModel:function(a){if(!this.getId()){this.setId(a.modelName)}Ext.data.proxy.Client.prototype.updateModel.apply(this,arguments)},create:function(e,h,j){var d=e.getRecords(),c=d.length,a=this.getIds(),b,g,f;e.setStarted();for(f=0;f<c;f++){g=d[f];b=g.getId();this.setRecord(g);a.push(b)}this.setIds(a);e.setCompleted();e.setSuccessful();if(typeof h==\"function\"){h.call(j||this,e)}},read:function(h,o,p){var e=[],a=this.getIds(),l=this.getModel(),q=l.getIdProperty(),g=h.getParams()||{},n=h.getSorters(),d=h.getFilters(),b=h.getStart(),f=h.getLimit(),c=a.length,j,k,m;if(g[q]!==undefined){k=this.getRecord(g[q]);if(k){e.push(k);h.setSuccessful()}}else{for(j=0;j<c;j++){k=this.getRecord(a[j]);if(k){e.push(k)}}m",340751,33,");if(d&&d.length){m.setFilters(d)}if(n&&n.length){m.setSorters(n)}m.addAll(e);if(this.getEnablePagingParams()&&b!==undefined&&f!==undefined){e=m.items.slice(b,b+f)}else{e=m.items.slice()}h.setSuccessful()}h.setCompleted();h.setResultSet(Ext.create(\"Ext.data.ResultSet\",{records:e,total:e.length,loaded:true}));h.setRecords(e);if(typeof o==\"function\"){o.call(p||this,h)}},update:function(e,h,j){var d=e.getRecords(),c=d.length,a=this.getIds(),g,b,f;e.setStarted();for(f=0;f<c;f++){g=d[f];this.setRecord(g);b=g.getId();if(b!==undefined&&Ext.Array.indexOf(a,b)==-1){a.push(b)}}this.setIds(a);e.setCompleted();e.setSuccessful();if(typeof h==\"function\"){h.call(j||this,e)}},destroy:function(b,h,e){var a=b.getRecords(),f=a.length,d=this.getIds(),g=[].concat(d),c;b.setStarted();for(c=0;c<f;c++){Ext.Array.remove(g,a[c].getId());this.removeRecord(a[c],false)}this.setIds(g);",369828,35,"if(typeof h==\"function\"){h.call(e||this,b)}},getRecord:function(c){if(this.cache[c]===undefined){var m=this.getRecordKey(c),n=this.getStorageObject().getItem(m),g={},e=this.getModel(),k=e.getFields().items,d=k.length,h,l,b,j,a,f;if(!n){return undefined}a=Ext.decode(n);for(h=0;h<d;h++){l=k[h];b=l.getName();f=a[b];if(typeof l.getDecode()==\"function\"){g[b]=l.getDecode()(f)}else{if(l.getType().type==\"date\"){g[b]=this.readDate(l,f)}else{g[b]=f}}}j=new e(g,c);this.cache[c]=j}return this.cache[c]},setRecord:function(l,c){if(c){l.setId(c)}else{c=l.getId()}var o=this,a=l.getData(),k={},f=o.getModel(),m=f.getFields().items,d=m.length,j=0,g,p,b,h,q;for(;j<d;j++){p=m[j];b=p.getName();g=a[b];if(p.getPersist()===false){continue}if(typeof p.getEncode()==\"function\"){k[b]=p.getEncode()(g,l)}else{if(p.getType().type==\"date\"&&Ext.isDate(g)){k[b]=this.writeDate(p,g)}else{k[b]=g}}}h=o.getStorageObject();q=o.getRecordKey(c);o.cache[c]=l;h.removeItem(q);try{h.setItem(q,Ext.encode(k))}catch(n",362495,34,"n)}l.commit()},removeRecord:function(d,c){var b=this,a;if(d.isModel){d=d.getId()}if(c!==false){a=b.getIds();Ext.Array.remove(a,d);b.setIds(a)}delete this.cache[d];b.getStorageObject().removeItem(b.getRecordKey(d))},getRecordKey:function(a){if(a.isModel){a=a.getId()}return Ext.String.format(\"{0}-{1}\",this.getId(),a)},getIds:function(){var b=(this.getStorageObject().getItem(this.getId())||\"\").split(\",\"),c=b.length,a;if(c==1&&b[0]===\"\"){b=[]}return b},setIds:function(a){var c=this.getStorageObject(),d=a.join(\",\"),f=this.getId();c.removeItem(f);if(!Ext.isEmpty(d)){try{c.setItem(f,",362485,44,"b)}}},writeDate:function(c,b){if(Ext.isEmpty(b)",364451,39,"this.getDefaultDateFormat()",364501,119,"readDate:function(c,b){if(Ext.isEmpty(b)",364451,39,"this.getDefaultDateFormat()",364501,34,"new Date(b*1000);case\"time\":return new Date(b);default:return Ext.isDate(b)?b:Ext.Date.parse(b,a)}},initialize:function(){Ext.data.proxy.Clien",505509,44,";var a=this.getStorageObject();try{a.setItem(this.getId(),a.getItem(this.getId())||\"\"",362486,43,"b)}},clear:function(){var d=this.getStorageObject(),c=this.getIds(),a=c.length,b;for(b=0;b<a;b++){this.removeRecord(c[b],false)}d.removeItem(this.getId())},getStorageObject:function(){}},1,0,0,0,0,0,[Ext.data.proxy,\"WebStorage\",Ext.data,\"WebStorage",370334,38,"proxy.LocalStorage\",Ext.data.proxy.WebStorag",392543,32,"LocalStorageProxy\",getStorageObject:function(){return window.localStorage}},0,0,0,0,[\"proxy.localstorage\"],0,[Ext.data.proxy,\"LocalStorage\",Ext.data,\"LocalStorage",370334,38,423388,54560,482719,23834,"model.User\",Ext.data.Model,{config:{fields:[{name:\"gender\",type:\"String\"},{name:\"birthday\",type:\"date\",dateFormat:\"time\"},{name:\"weight\",type:\"float\"},{name:\"height\",type:\"float\"},{name:\"lastReStartAt\",type:\"date\",dateFormat:\"time\"},{name:\"score\",type:\"int\",defaultValue:0},{name:\"currentSugarLevel\",type:\"float\",defaultValue:0},{name:\"currentEnviromentLevel\",type:\"float\",defaultValue:0}],proxy:{type:\"localstorage\",id:\"user\"},identifier:{type:\"uuid\"},validations:[{type:\"inclusion\",field:\"gender\",list:[\"MALE\",\"FEMALE\"]},{type:\"presence\",field:\"age\"},{type:\"presence\",field:\"weight\"},{type:\"presence\",field:\"height\"}]},getKcal:function(){var b=this,e,d,c,a;if(b.get(\"gender\")===\"MALE\"){e=66.5;d=13.75;c=5;a=6.78}else{e=665;d=9.56;c=1.85;a=4.68}return e+(d*b.get(\"weight\"))+(c*b.get(\"height\"))-(a*b.getAge())},getAge:function(){var b=Date.now()-this.get(\"birthday\").getTime();var a=new Date(b);return Math.abs(a.getUTCFullYear()-1970)}},0,0,0,0,[\"model.User\"],0,[DietonApp.model,\"User",506519,34,"model.Config\",Ext.data.Model,{config:{fields:[{name:\"id\"},{name:\"last_route\",type:\"String\"},{name:\"last_server_url\",type:\"String\"}],proxy:{type:\"localstorage\",id:\"config\"},identifier:{type:\"uuid\"}}},0,0,0,0,0,0,[DietonApp.model,\"Config",506519,34,"model.History\",Ext.data.Model,{config:{idProperty:\"id\",fields:[{name:\"createdAt\",type:\"date\",dateFormat:\"time\"},{name:\"barCode\",type:\"String\"},{name:\"enviromentLevel\",type:\"int\"},{name:\"puppetLevel\",type:\"int\"},{name:\"latitudeOrigin\",type:\"float\"},{name:\"longitudeOrigin\",type:\"float\"},{name:\"currentLatitude\",type:\"float\"},{name:\"currentLongitude\",type:\"float\"},{name:\"currentAccuracy\",type:\"float\"},{name:\"productName\",type:\"String\"},{name:\"productSize\",type:\"float\"},{name:\"productSugar\",type:\"float\"},{name:\"productFat\",type:\"float\"}],proxy:{type:\"localstorage\",id:\"history\"},identifier:{type:\"uuid\"}}},0,0,0,0,[\"model.History\"],0,[DietonApp.model",332481,33,"DietonApp.store.Config\",Ext.data.Store,{config:{autoLoad:true,model:\"DietonApp.model.Config\",storeId:\"Config\",proxy:{type:\"localstorage\",id:\"config\"}}},0,0,0,0,0,0,[DietonApp.store,\"Config",506519,34,"store.History\",Ext.data.Store,{config:{autoLoad:true,model:\"DietonApp.model.History\",storeId:\"History\",proxy:{type:\"localstorage\",id:\"history\"},sorters:[{property:\"creationDate\",direction:\"DESC\"}]}},0,0,0,0,0,0,[DietonApp.store",332481,33,"DietonApp.store.User\",Ext.data.Store,{config:{autoLoad:true,model:\"DietonApp.model.User\",storeId:\"User\",proxy:{type:\"localstorage\",id:\"user\"}}},0,0,0,0,0,0,[DietonApp.store,\"User",506519,34,"controller.Router\",Ext.app.Controller,{config:{views:[],before:{showHome:[\"authenticate\",\"showHome\",\"saveRoute\"],showEditUser:[\"checkUserId\",\"saveRoute\"]},routes:{\"\":\"showHome\",createAccount:\"showCreateUser\",\"user/:id\":\"showEditUser\"},refs:{},control:{backButton:{tap:\"onBackButtonTap\"}}},launch:function(a){},createFakeUser:function(){var b=new Date();b.setHours(0);var a=Ext.create(\"DietonApp.model.User\",{gender:\"FEMALE\",birthday:new Date(2008,0,1),weight:28,height:115,lastReStartAt:b,score:10,currentSugarLevel:0});a.save()},authenticate:function(b){var a=this;if(!a.getApplication().getCurrentUser()){a.createFakeUser();b.resume()}else{b.resume()}},restoreLastRoute:function(b){if(b.getUrl()===\"\"){var a=this.getApplication().getConfig();if(a.get(\"last_route\")&&a.get(\"last_route\")!==\"\"){this",331978,34,"(\"last_route\"))}else{b.resume()}}else{b.resume()}},saveRoute:function(b){var a=this.getApplication().getConfig();a.set(\"last_route\",b.getUrl());a.save();b.resume()},checkUserAccount:function(b){var a=this;if(!a.getApplication().getDefaultUser()){a.getApplication().redirectTo(\"accounts\")}else{if(a.getApplication().getCurrentUser()){a.getApplication().redirectTo(\"balance\")}else{b.resume()}}},checkUserId:function(b){var a=this;var c=function(){var d=Ext.getStore(\"User\").findRecord(\"id\",b.getArgs()[0]);if(d){b.resume()}else{a.getApplication().alertFailure(\"No Usuario\",\"La cuenta de usuario especificada no existe\")}};if(Ext.getStore(\"User\").getCount()===0){Ext.getStore(\"User\").load({callback:function(){c()}})}else{c()}},showHome:function(){var a=Ext.create(\"DietonApp.view.Home\");this.showView(a);a.fireEvent(\"init\",a)},showCreateUser:function(){this.showView(Ext.create(\"DietonApp.view.CreateUser\"))},showView:function(a){this.cleanViewPort(true);Ext.Viewport.add(a)},cleanViewPort:function(a){var c=this,b=null;Ext.Viewport.getItems().each(function(e,d){if((e.getItemId()!==b)){if(e.getId()===Ext.Msg.getId()){a=false}else{if(e.getId&&e.getId().indexOf(\"mask\")>=0){a=false}}Ext.Viewport.remove(e,a)}else{if(!c.getApplication().getCurrentUser()){Ext.Viewport.remove(e,true)}}})}},0,0,0,0,0,0,[DietonApp.controller,\"Router",506519,39,"Home\",Ext.Panel,{config:{itemId:\"homeView\",layout:\"vbox\",scrollable:true,items:[{xtype:\"container\",margin:\"5px auto\",itemId:\"drawingContainer\",tpl:new Ext.XTemplate('<div class=\"background-puppet {[this.getEnviromentCls(values)]}\" style=\"height:{[this.getWindowHeight()]};\">','<img style=\"margin-left:{[this.getPuppetMarginLeft(values)]}; margin-top:{[this.getPuppetMarginTop(values)]};\" class=\"{[this.getPuppetCls(values)]}\" src=\"{[this.getPuppetImg(values)]}\" />',\"</div>\",{",497487,34,"Ext.Viewport.windowHeight-45+\"px !important\"",504538,35,"Ext.Viewport.windowWidth},getEnviromentCls:function(a){switch(a.enviromentLevel){case 1:return\"first-state\";break;case 2:return\"second-state\";break;case 3:return\"neutral-state\";break;case 4:return\"fourth-state\";break;case 5:return\"fifth-state\";break;default:return\"\"}},getPuppetImg:function(a){switch(a.puppetLevel){case 1:return\"resources/icons/puppets/Personaje-01.png\";break;case 2:return\"resources/icons/puppets/Personaje-02.png\";break;case 3:return\"resources/icons/puppets/Personaje-03.png\";break;case 4:return\"resources/icons/puppets/Personaje-04.png\";break;case 5:return\"resources/icons/puppets/Personaje-05.png\";break;default:return\"\"}},getPuppetCls:function(a){switch(a.puppetLevel){case 1:return\"puppet-first-state\";break;case 2:return\"puppet-second-state\";break;case 3:return\"puppet-neutral-state\";break;case 4:return\"puppet-fourth-state\";break;case 5:return\"puppet-fifth-state\";break;default:return\"\"}},getPuppetMarginLeft:function(a){switch(a.puppetLevel){case 1:return((Ext.Viewport.windowWidth-500)/2)+\"px !important\";break;case 2:return((Ext.Viewport.windowWidth-450)/2)+\"px !important\";break;case 3:return((Ext.Viewport.windowWidth-400)/2)+\"px !important\";break;case 4:return((Ext.Viewport.windowWidth-350)/2)+\"px !important\";break;case 5:return((Ext.Viewport.windowWidth-300)/2)+\"px !important\";break;default:return\"\"}},getPuppetMarginTop:function(a){switch(a.puppetLevel){case 1:return((Ext.Viewport.windowHeight-800)/2)+\"px !important\";break;case 2:return((Ext.Viewport.windowHeight-750)/2)+\"px !important\";break;case 3:return((Ext.Viewport.windowHeight-700)/2)+\"px !important\";break;case 4:return((Ext.Viewport.windowHeight-650)/2)+\"px !important\";break;case 5:return((Ext.Viewport.windowHeight-600)/2)+\"px !important\";break;default:return\"\"}}})},{xtype:\"container\",layout:\"hbox\",docked:\"bottom\",items:[{xtype:\"button\",itemId:\"searchProduct\",height:60,flex:1,text:\"Buscar Producto\",iconAlign:\"center\",iconCls:\"tickIcon\",icon:\"resources/icons/buttons/BOTONES-45-02.png\",cls:\"button-ivan2\"},{xtype:\"button\",itemId:\"captureBarcode\",height:60,flex:1,text:\"Escanear C\ufffff\ufffffdigo\",iconAlign:\"center\",iconCls:\"tickIcon\",icon:\"resources/icons/buttons/BOTONES-45-01.png\",cls:\"button-ivan2\"}]},{xtype:\"container\",itemId:\"productInfo\",cls:\"product-info\",hidden:true,height:175,tpl:new Ext.XTemplate('<div class=\"\">',\"<center><div>{product_name}</div></center>\",\"<table>\",\"<thead></thead>\",\"<tbody>\",\"<tr>\",\"<td>Az\ufffff\ufffffcares: </td>\",\"<td>{[this.getSugars(values)]}</td>\",\"</tr>\",\"<tr>\",\"<td>Grasa Saturada: </td>\",\"<td>{[this.getSaturatedFat(values)]}</td>\",\"</tr>\",\"<tr>\",\"<td>Huella Ecol\ufffff\ufffffgica: </td>\",\"<td>{[this.getEcoFootPrint(values)]}</td>\",\"</tr>\",\"</tbody>\",\"</table>\",\"</div>\",{getEcoFootPrint:function(a){if(a.ecoFootprint){return a.ecoFootprint.toFixed(2)+\"g de CO2\"}else{return\"No calculada\"}},getSaturatedFat:function(a){if(a.nutriments[\"saturated-fat\"]){return a.nutriments[\"saturated-fat\"]+\"g\"}return\"\"},getSugars:function(a){if(a.nutriments.sugars){return a.nutriments.sugars+\"g\"}return\"\"}}),items:[{xtype:\"container\",layout:\"hbox\",docked:\"bottom\",cls:\"product-info-buttons\",items:[{xtype:\"button\",itemId:\"reject\",text:\"\",width:82,height:85,docked:\"left\",iconAlign:\"center\",iconCls:\"tickIcon\",icon:\"resources/icons/buttons/BOTONES-45-03.png\",cls:\"button-ivan\"},{xtype:\"button\",itemId:\"approve\",text:\"\",width:82,height:85,docked:\"right\",iconCls:\"tickIcon\",icon:\"resources/icons/buttons/BOTONES-45-04.png\",iconAlign:\"center\",cls:\"button-ivan\"}]}]}]}},0,[\"homeview",283976,37,"homeview",479824,34,"panel:true,homeview:true},[\"widget.homeview\"],0,[DietonApp.view,\"Home",506519,34,"controller.Home\",Ext.app.Controller,{config:{lasProductFind:null,views:[\"Home\"],refs:{homeView:\"homeview\",reloadBalanceButton:\"homeview balancetoolbar button#reloadBalance\",captureBarcodeButton:\"homeview button#captureBarcode\",approveButton:\"homeview button#approve\",rejectButton:\"homeview button#reject\",searchButton:\"homeview button#searchProduct\"},control:{homeView:{init:\"onInitHomeView\",goback:\"onHomeViewGoBack\"},captureBarcodeButton:{tap:\"onCaptureBarcodeButtonTap\"},approveButton:{tap:\"onApproveButtonTap\"},rejectButton:{tap:\"onRejectButtonTap\"},searchButton:{tap:\"onSearchButtonTap\"}}},launch:function(a){},onHomeViewGoBack:function(b,a){a()},onInitHomeView:function(b){var f=this,a=f.getApplication().getCurrentUser(),d=new Date(),e=Ext.getStore(\"History\");d.setHours(0,0,0,0);e.filterBy(function(g){return g.get(\"createdAt\").getTime()>=d.getTime()});var c;if(e.getCount()){c=e.last()}else{c=Ext.create(\"DietonApp.model.History\",{enviromentLevel:3,puppetLevel:3})}b.down(\"container#drawingContainer\").setRecord(c);b.down(\"container#drawingContainer\").setHeight(Ext.Viewport.windowHeight-175)},onReloadBalanceButtonTap:function(){this.updateBalance()},onCaptureBarcodeButtonTap:function(){var a=this;if(window.cordova){cordova.plugins.barcodeScanner.scan(function(b){if(!b.cancelled){a.createNewHistory(b)}},function(b){Ext.Msg.alert(\"Scanning failed: \"+b)})}else{a.createNewHistory(\"5449000051981\")}},onApproveButtonTap:function(){var i=this,b=i.getApplication().getActiveView(),k=b.down(\"container#productInfo\").getData(),c=i.getApplication().getCurrentUser();var j=k.quantity.split(\" \")[0];var a=100*k.nutriments.sugars/90;var h=c.get(\"currentSugarLevel\")+(a*c.getKcal()/2000);var f=c.get(\"currentEnviromentLevel\")+(k.ecoFootprint)?k.ecoFootprint:0;if((a*c.getKcal()/2000)<=5){h-=10}var d,e;if(h<=0){d=1}else{if(h<=20){d=2}else{if(h<=60){d=3}else{if(h<=100){d=4}else{d=5}}}}if(((k.ecoFootprint)?k.ecoFootprint:0)<=5){f-=10}if(f<=0){e=1}else{if(f<=20){e=2}else{if(f<=60){e=3}else{if(f<=100){e=4}else{e=5}}}}var g=Ext.create(\"DietonApp.model.History\",{barCode:k.barcode,enviromentLevel:e,puppetLevel:d,latitudeOrigin:k.latitudeOrigin,longitudeOrigin:k.longitudeOrigin,currentLatitude:k.currentLatitude,currentLongitude:k.currentLongitude,currentAccuracy:k.currentAccuracy,productName:k.product_name,productSize:j,productSugar:k.nutriments.sugars,productFat:k.nutriments[\"saturated-fat\"],createdAt:new Date()});g.save();c.set(\"currentSugarLevel\",h);c.set(\"currentEnviromentLevel\",f);c.save();b.down(\"container#drawingContainer\").setRecord(g);b.down(\"button#captureBarcode\").show();b.down(\"button#searchProduct\").show();b.down(\"container#productInfo\").setData(null);b.down(\"container#productInfo\").hide()},onRejectButtonTap:function(){var b=this,a=b.getApplication().getActiveView();a.down(\"button#captureBarcode\").show();a.down(\"button#searchProduct\").show();a.down(\"container#productInfo\").setData(null);a.down(\"container#productInfo\").hide()},onSearchButtonTap:function(){Ext.Msg.alert(\"\",'Pronto podr\ufffff\ufffffs buscar sin utilizar el sistema de escaneo, mientras tanto te animamos a que escanees el c\ufffff\ufffffdigo de barras de cada producto con el bot\ufffff\ufffffn \"Escanear C\ufffff\ufffffdigo\"')},createNewHistory:function(a){var b=this;b.getApplication().loadingMask(true,\"Consultando\");Ext.Ajax.request({url:\"http://world.openfoodfacts.org/api/v0/product/\"+a.text+\".json\",disableCaching:false,method:\"GET\",success:function(d){console.log(a.text+\"*****RES ANDRES**--> \"+d.responseText);var c=JSON.parse(d.responseText);if(c.status===1){c.product.barcode=a.text;var e=function(g){var f=b.getApplication().getActiveView();f.down(\"button#captureBarcode\").hide();f.down(\"button#searchProduct\").hide();f.down(\"container#productInfo\").setData(g);f.down(\"container#productInfo\").show()};navigator.geolocation.getCurrentPosition(function(g){c.product.currentLatitude=g.coords.latitude;c.product.currentLongitude=g.coords.longitude;c.product.currentAccuracy=g.coords.accuracy;var f=new google.maps.Geocoder();f.geocode({address:c.product.countries},function(i,h){if(h===google.maps.GeocoderStatus.OK){var j=i[0].geometry.location;c.product.latitudeOrigin=j.lat();c.product.longitudeOrigin=j.lng();var k=b.getDistanceFromLatLonInKm(c.product.latitudeOrigin,c.product.longitudeOrigin,g.coords.latitude,g.coords.longitude);c.product.ecoFootprint=0.35*k}e(c.product);b.getApplication().loadingMask(false)})},function(f){b.getApplication().loadingMask(false);e(c.product)})}else{b.getApplication().loadingMask(false);Ext.Msg.alert(\"Error\",\"No fue posible realizar la consulta, int\ufffff\ufffffntalo de nuevo.\")}},failure:function(c){b.getApplication().loadingMask(false);Ext.Msg.alert(\"Error\",\"No fue posible realizar la consulta, int\ufffff\ufffffntalo de nuevo.\")},callback:function(d,e,c){console.log(\"Response success: \"+e);console.log(\"responseText: \"+c.responseText);console.log(\"responseStatus: \"+c.status)}})},getDistanceFromLatLonInMeters:function(e,c,d,b){var a=this;return a.getDistanceFromLatLonInKm(e,c,d,b)*1000/1},getDistanceFromLatLonInKm:function(f,i,e,h){var g=6371,k=this.deg2rad(e-f),b=this.deg2rad(h-i),m=Math.sin(k/2)*Math.sin(k/2)+Math.cos(this.deg2rad(f))*Math.cos(this.deg2rad(e))*Math.sin(b/2)*Math.sin(b/2),l=2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m)),j=g*l;return j},deg2rad:function(a){return a*(Math.PI/180)}},0,0,0,0,0,0,[DietonApp.controller,\"Home",506519,39,"ux.LoadingMask\",Ext.LoadMask,{config:{zIndex:998}},0,[\"loading",302825,37,",\"loading",302857,46,",loadingmask:true},[\"widget.loadingmask\"],0,[DietonApp.view.ux,\"LoadingMask",507450,41,"controllers:[\"Router\",\"Home\"],stores:[\"Config\",\"History\",\"User\"],models:[\"User\",\"Config\",\"History\"],views:[\"ux.LoadingMask",507503,458,"getConfig:function(){if(Ext.getStore(\"Config\").getCount()===0){Ext.getStore(\"Config\").load()}return Ext.getStore(\"Config\").first()},getCurrentUser:function(){if(Ext.getStore(\"User\").getCount()===0){Ext.getStore(\"User\").load()}return Ext.getStore(\"User\").first()},getActiveView:function(){return Ext.Viewport.getActiveItem()},getActiveRoute:function(){var a=this.getHistory(),b=a.getActions();return b[b.length-1].config",507959,61,"window.initMaps()},ldMask:null,loading:false,getLdMask:function(){return this.ldMask},setLdMask:function(a){this.ldMask=a},isLoading:function(){return this.loading},setLoading:function(a){this.loading=a},loadingMask:function(a,c){c=c||\"Cargando...\";this.setLoading(a);if(a){if(this.getLdMask()!==null){this.getLdMask().setMessage(c)}else{Ext.Viewport.setMasked({xtype:\"loadingmask\",message:c});this.setLdMask(Ext.Viewport.getMasked())}}else{var d=this.getLdMask();this.setLdMask(null);Ext.Viewport.setMasked(false)}",508071,206]